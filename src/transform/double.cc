// Copyright 2013-2015 Stanford University
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

#include "src/transform/double.h"

using namespace std;
using namespace stoke;
using namespace x64asm;

struct gadget {
  int opcode1;
  int index;
  int opcode2;
};


static const gadget choices[] = {
  {2404,1,2361},//('shrdq_r64_r64_imm8', '1', 'shldq_r64_r64_imm8')
  {3831,0,199},//('xorq_r64_imm8', '0', 'bsrq_r64_r64')
  {2207,-1,76},//('sbbq_r64_imm8', '-1', 'addb_r8_r8')
  {2499,1,2341},//('testq_m64_r64', '1', 'shlq_r64_cl')
  {1453,0,2385},//('orq_r64_r64', '0', 'shrq_r64_imm8')
  {1453,1,1453},//('orq_r64_r64', '1', 'orq_r64_r64')
  {2169,0,2461},//('sarq_r64_imm8', '0', 'subq_r64_r64')
  {2169,0,2460},//('sarq_r64_imm8', '0', 'subq_r64_m64')
  {2065,0,2065},//('rolw_r16_imm8', '0', 'rolw_r16_imm8')
  {2278,-1,598},//('setne_r8', '-1', 'decl_m32')
  {2459,0,1926},//('subq_r64_imm8', '0', 'pushq_r64_1')
  {2278,-1,840},//('setne_r8', '-1', 'incl_m32')
  {72,1,2342},//('addq_r64_r64', '1', 'shlq_r64_imm8')
  {1453,0,2386},//('orq_r64_r64', '0', 'shrq_r64_one')
  {3832,0,3832},//('xorq_r64_m64', '0', 'xorq_r64_m64')
  {828,0,2169},//('imulq_r64_r64', '0', 'sarq_r64_imm8')
  {72,0,2342},//('addq_r64_r64', '0', 'shlq_r64_imm8')
  {2379,0,126},//('shrw_r16_imm8', '0', 'andw_r16_imm16')
  {1457,0,2248},//('orb_r8_r8', '0', 'sete_r8')
  {1457,1,2248},//('orb_r8_r8', '1', 'sete_r8')
  {3833,0,2098},//('xorq_r64_r64', '0', 'rorq_r64_imm8')
  {292,-1,477},//('cmovbeq_r64_r64', '-1', 'cmpq_r64_r64')
  {2388,0,2388},//('shrb_r8_imm8', '0', 'shrb_r8_imm8')
  {2342,0,70},//('shlq_r64_imm8', '0', 'addq_r64_imm8')
  {2098,0,3833},//('rorq_r64_imm8', '0', 'xorq_r64_r64')
  {139,0,1422},//('andq_r64_r64', '0', 'notq_r64')
  {2204,-1,470},//('sbbl_r32_r32', '-1', 'cmpl_r32_imm8')
  {2458,0,1926},//('subq_r64_imm32', '0', 'pushq_r64_1')
  {122,1,1422},//('andq_m64_r64', '1', 'notq_r64')
  {1462,0,148},//('orb_rh_imm8', '0', 'andb_rh_imm8')
  {278,-1,470},//('cmovael_r32_r32', '-1', 'cmpl_r32_imm8')
  {364,-1,2508},//('cmovneq_r64_r64', '-1', 'testq_r64_r64')
  {477,1,70},//('cmpq_r64_r64', '1', 'addq_r64_imm8')
  {1422,0,2209},//('notq_r64', '0', 'sbbq_r64_r64')
  {450,0,2434},//('cmpw_ax_imm16', '0', 'subw_ax_imm16')
  {304,-1,2508},//('cmoveq_r64_r64', '-1', 'testq_r64_r64')
  {126,0,2380},//('andw_r16_imm16', '0', 'shrw_r16_one')
  {474,0,1134},//('cmpq_r64_imm32', '0', 'leaq_r64_m16')
  {828,0,612},//('imulq_r64_r64', '0', 'divq_r64')
  {476,0,2459},//('cmpq_r64_m64', '0', 'subq_r64_imm8')
  {485,0,147},//('cmpq_rax_imm32', '0', 'andq_rax_imm32')
  {475,0,2461},//('cmpq_r64_imm8', '0', 'subq_r64_r64')
  {3832,0,2386},//('xorq_r64_m64', '0', 'shrq_r64_one')
  {3833,0,2385},//('xorq_r64_r64', '0', 'shrq_r64_imm8')
  {2239,-1,471},//('setb_r8', '-1', 'cmpl_r32_m32')
  {320,-1,472},//('cmovll_r32_r32', '-1', 'cmpl_r32_r32')
  {3833,0,3833},//('xorq_r64_r64', '0', 'xorq_r64_r64')
  {2342,0,263},//('shlq_r64_imm8', '0', 'cltq')
  {1457,0,2236},//('orb_r8_r8', '0', 'setae_r8')
  {830,1,139},//('imulq_r64_r64_imm8', '1', 'andq_r64_r64')
  {2342,0,72},//('shlq_r64_imm8', '0', 'addq_r64_r64')
  {14,-1,57},//('adcb_m8_r8', '-1', 'addb_m8_r8')
  {440,-1,2506},//('cmovsl_r32_r32', '-1', 'testl_r32_r32')
  {2169,0,824},//('sarq_r64_imm8', '0', 'imulq_r64')
  {2510,0,2278},//('testb_r8_r8', '0', 'setne_r8')
  {2510,1,2278},//('testb_r8_r8', '1', 'setne_r8')
  {3833,0,590},//('xorq_r64_r64', '0', 'cvttsd2siq_r64_xmm')
  {2508,1,2169},//('testq_r64_r64', '1', 'sarq_r64_imm8')
  {2508,0,2169},//('testq_r64_r64', '0', 'sarq_r64_imm8')
  {476,0,2458},//('cmpq_r64_m64', '0', 'subq_r64_imm32')
  {3770,0,3770},//('xchgw_ax_r16', '0', 'xchgw_ax_r16')
  {3770,1,3770},//('xchgw_ax_r16', '1', 'xchgw_ax_r16')
  {72,0,72},//('addq_r64_r64', '0', 'addq_r64_r64')
  {325,-1,455},//('cmovlel_r32_m32', '-1', 'cmpl_m32_imm32')
  {2204,-1,449},//('sbbl_r32_r32', '-1', 'cmpb_al_imm8')
  {2239,-1,472},//('setb_r8', '-1', 'cmpl_r32_r32')
  {143,1,2278},//('andb_r8_r8', '1', 'setne_r8')
  {2257,-1,457},//('setl_r8', '-1', 'cmpl_m32_r32')
  {474,0,2461},//('cmpq_r64_imm32', '0', 'subq_r64_r64')
  {2236,-1,2525},//('setae_r8', '-1', 'ucomiss_xmm_xmm')
  {286,-1,477},//('cmovbq_r64_r64', '-1', 'cmpq_r64_r64')
  {2248,-1,470},//('sete_r8', '-1', 'cmpl_r32_imm8')
  {442,1,1408},//('cmovsq_r64_r64', '1', 'negq_r64')
  {2209,-1,470},//('sbbq_r64_r64', '-1', 'cmpl_r32_imm8')
  {2204,-1,479},//('sbbl_r32_r32', '-1', 'cmpb_r8_imm8')
  {55,1,263},//('addq_m64_r64', '1', 'cltq')
  {326,-1,472},//('cmovlel_r32_r32', '-1', 'cmpl_r32_r32')
  {2388,0,2389},//('shrb_r8_imm8', '0', 'shrb_r8_one')
  {70,0,2459},//('addq_r64_imm8', '0', 'subq_r64_imm8')
  {308,-1,472},//('cmovgl_r32_r32', '-1', 'cmpl_r32_r32')
  {2504,1,2379},//('testw_r16_r16', '1', 'shrw_r16_imm8')
  {2504,0,2379},//('testw_r16_r16', '0', 'shrw_r16_imm8')
  {143,0,2278},//('andb_r8_r8', '0', 'setne_r8')
  {485,0,2461},//('cmpq_rax_imm32', '0', 'subq_r64_r64')
  {1453,1,139},//('orq_r64_r64', '1', 'andq_r64_r64')
  {284,-1,472},//('cmovbl_r32_r32', '-1', 'cmpl_r32_r32')
  {2469,0,2342},//('subq_rax_imm32', '0', 'shlq_r64_imm8')
  {308,-1,469},//('cmovgl_r32_r32', '-1', 'cmpl_r32_imm32')
  {1436,1,2341},//('orq_m64_r64', '1', 'shlq_r64_cl')
  {1453,0,139},//('orq_r64_r64', '0', 'andq_r64_r64')
  {2233,-1,2522},//('seta_r8', '-1', 'ucomisd_xmm_m64')
  {290,-1,472},//('cmovbel_r32_r32', '-1', 'cmpl_r32_r32')
  {314,-1,472},//('cmovgel_r32_r32', '-1', 'cmpl_r32_r32')
  {477,0,70},//('cmpq_r64_r64', '0', 'addq_r64_imm8')
  {2242,-1,470},//('setbe_r8', '-1', 'cmpl_r32_imm8')
  {477,0,1134},//('cmpq_r64_r64', '0', 'leaq_r64_m16')
  {70,0,46},//('addq_r64_imm8', '0', 'addl_eax_imm32')
  {3833,1,829},//('xorq_r64_r64', '1', 'imulq_r64_r64_imm32')
  {71,0,2342},//('addq_r64_m64', '0', 'shlq_r64_imm8')
  {2461,0,3833},//('subq_r64_r64', '0', 'xorq_r64_r64')
  {568,1,1453},//('cvtsi2sdq_xmm_r64', '1', 'orq_r64_r64')
  {2169,0,2361},//('sarq_r64_imm8', '0', 'shldq_r64_r64_imm8')
  {1453,1,2342},//('orq_r64_r64', '1', 'shlq_r64_imm8')
  {2278,-1,459},//('setne_r8', '-1', 'cmpq_m64_imm8')
  {464,0,126},//('cmpw_r16_imm16', '0', 'andw_r16_imm16')
  {2248,-1,460},//('sete_r8', '-1', 'cmpq_m64_r64')
  {1453,0,132},//('orq_r64_r64', '0', 'andl_r32_imm8')
  {364,-1,459},//('cmovneq_r64_r64', '-1', 'cmpq_m64_imm8')
  {274,-1,477},//('cmovaq_r64_r64', '-1', 'cmpq_r64_r64')
  {2169,0,2469},//('sarq_r64_imm8', '0', 'subq_rax_imm32')
  {477,1,1134},//('cmpq_r64_r64', '1', 'leaq_r64_m16')
  {830,1,263},//('imulq_r64_r64_imm8', '1', 'cltq')
  {2248,-1,461},//('sete_r8', '-1', 'cmpb_m8_imm8')
  {139,0,2384},//('andq_r64_r64', '0', 'shrq_r64_cl')
  {72,0,2469},//('addq_r64_r64', '0', 'subq_rax_imm32')
  {2278,-1,2506},//('setne_r8', '-1', 'testl_r32_r32')
  {2248,-1,2506},//('sete_r8', '-1', 'testl_r32_r32')
  {2248,-1,479},//('sete_r8', '-1', 'cmpb_r8_imm8')
  {2385,0,824},//('shrq_r64_imm8', '0', 'mulq_r64')
  {70,0,263},//('addq_r64_imm8', '0', 'cltq')
  {71,0,830},//('addq_r64_m64', '0', 'imulq_r64_r64_imm8')
  {477,1,2461},//('cmpq_r64_r64', '1', 'subq_r64_r64')
  {2278,-1,2493},//('setne_r8', '-1', 'testl_eax_imm32')
  {310,-1,459},//('cmovgq_r64_r64', '-1', 'cmpq_m64_imm8')
  {1453,1,137},//('orq_r64_r64', '1', 'andq_r64_imm8')
  {72,0,263},//('addq_r64_r64', '0', 'cltq')
  {829,1,2461},//('imulq_r64_r64_imm32', '1', 'subq_r64_r64')
  {139,0,1408},//('andq_r64_r64', '0', 'negq_r64')
  {3833,0,139},//('xorq_r64_r64', '0', 'andq_r64_r64')
  {477,1,2169},//('cmpq_r64_r64', '1', 'sarq_r64_imm8')
  {450,0,112},//('cmpw_ax_imm16', '0', 'andw_ax_imm16')
  {2342,0,286},//('shlq_r64_imm8', '0', 'cmovbq_r64_r64')
  {2461,1,829},//('subq_r64_r64', '1', 'imulq_r64_r64_imm32')
  {280,-1,477},//('cmovaeq_r64_r64', '-1', 'cmpq_r64_r64')
  {404,-1,2506},//('cmovnsl_r32_r32', '-1', 'testl_r32_r32')
  {2207,0,304},//('sbbq_r64_imm8', '0', 'cmoveq_r64_r64')
  {2257,-1,472},//('setl_r8', '-1', 'cmpl_r32_r32')
  {304,-1,2500},//('cmoveq_r64_r64', '-1', 'testb_m8_imm8')
  {3833,1,72},//('xorq_r64_r64', '1', 'addq_r64_r64')
  {2461,0,137},//('subq_r64_r64', '0', 'andq_r64_imm8')
  {304,-1,141},//('cmoveq_r64_r64', '-1', 'andb_r8_imm8')
  {2278,-1,2508},//('setne_r8', '-1', 'testq_r64_r64')
  {460,1,70},//('cmpq_m64_r64', '1', 'addq_r64_imm8')
  {143,0,2248},//('andb_r8_r8', '0', 'sete_r8')
  {139,0,3833},//('andq_r64_r64', '0', 'xorq_r64_r64')
  {481,1,2388},//('cmpb_r8_r8', '1', 'shrb_r8_imm8')
  {2461,1,2342},//('subq_r64_r64', '1', 'shlq_r64_imm8')
  {304,-1,2491},//('cmoveq_r64_r64', '-1', 'testb_al_imm8')
  {2239,-1,460},//('setb_r8', '-1', 'cmpq_m64_r64')
  {310,-1,477},//('cmovgq_r64_r64', '-1', 'cmpq_r64_r64')
  {126,0,2379},//('andw_r16_imm16', '0', 'shrw_r16_imm8')
  {475,0,2469},//('cmpq_r64_imm8', '0', 'subq_rax_imm32')
  {2248,-1,456},//('sete_r8', '-1', 'cmpl_m32_imm8')
  {2508,0,603},//('testq_r64_r64', '0', 'decq_r64')
  {2508,1,603},//('testq_r64_r64', '1', 'decq_r64')
  {2242,-1,449},//('setbe_r8', '-1', 'cmpb_al_imm8')
  {72,0,830},//('addq_r64_r64', '0', 'imulq_r64_r64_imm8')
  {1422,0,2341},//('notq_r64', '0', 'shlq_r64_cl')
  {2209,-1,479},//('sbbq_r64_r64', '-1', 'cmpb_r8_imm8')
  {314,-1,470},//('cmovgel_r32_r32', '-1', 'cmpl_r32_imm8')
  {71,0,825},//('addq_r64_m64', '0', 'imulq_r64_m64')
  {465,0,126},//('cmpw_r16_imm8', '0', 'andw_r16_imm16')
  {361,-1,461},//('cmovnel_r32_m32', '-1', 'cmpb_m8_imm8')
  {199,1,2169},//('bsrq_r64_r64', '1', 'sarq_r64_imm8')
  {362,-1,2506},//('cmovnel_r32_r32', '-1', 'testl_r32_r32')
  {112,0,2379},//('andw_ax_imm16', '0', 'shrw_r16_imm8')
  {308,-1,451},//('cmovgl_r32_r32', '-1', 'cmpl_eax_imm32')
  {2508,0,828},//('testq_r64_r64', '0', 'imulq_r64_r64')
  {2508,1,828},//('testq_r64_r64', '1', 'imulq_r64_r64')
  {2170,0,72},//('sarq_r64_one', '0', 'addq_r64_r64')
  {2277,-1,459},//('setne_m8', '-1', 'cmpq_m64_imm8')
  {1451,0,132},//('orq_r64_imm8', '0', 'andl_r32_imm8')
  {328,-1,459},//('cmovleq_r64_r64', '-1', 'cmpq_m64_imm8')
  {2404,0,2342},//('shrdq_r64_r64_imm8', '0', 'shlq_r64_imm8')
  {304,-1,2506},//('cmoveq_r64_r64', '-1', 'testl_r32_r32')
  {477,1,828},//('cmpq_r64_r64', '1', 'imulq_r64_r64')
  {2458,0,2342},//('subq_r64_imm32', '0', 'shlq_r64_imm8')
  {481,0,2388},//('cmpb_r8_r8', '0', 'shrb_r8_imm8')
  {304,1,1134},//('cmoveq_r64_r64', '1', 'leaq_r64_m16')
  {2385,0,1422},//('shrq_r64_imm8', '0', 'notq_r64')
  {2248,-1,449},//('sete_r8', '-1', 'cmpb_al_imm8')
  {2510,0,2248},//('testb_r8_r8', '0', 'sete_r8')
  {80,0,2342},//('addq_rax_imm32', '0', 'shlq_r64_imm8')
  {2461,1,2169},//('subq_r64_r64', '1', 'sarq_r64_imm8')
  {2389,0,2388},//('shrb_r8_one', '0', 'shrb_r8_imm8')
  {477,1,72},//('cmpq_r64_r64', '1', 'addq_r64_r64')
  {304,-1,461},//('cmoveq_r64_r64', '-1', 'cmpb_m8_imm8')
  {572,1,1453},//('cvtsi2ssq_xmm_r64', '1', 'orq_r64_r64')
  {2343,0,2461},//('shlq_r64_one', '0', 'subq_r64_r64')
  {2510,0,2236},//('testb_r8_r8', '0', 'setae_r8')
  {139,1,72},//('andq_r64_r64', '1', 'addq_r64_r64')
  {2204,-1,456},//('sbbl_r32_r32', '-1', 'cmpl_m32_imm8')
  {316,-1,477},//('cmovgeq_r64_r64', '-1', 'cmpq_r64_r64')
  {1453,0,1422},//('orq_r64_r64', '0', 'notq_r64')
  {280,-1,475},//('cmovaeq_r64_r64', '-1', 'cmpq_r64_imm8')
  {2510,1,2239},//('testb_r8_r8', '1', 'setb_r8')
  {2510,0,2239},//('testb_r8_r8', '0', 'setb_r8')
  {328,-1,477},//('cmovleq_r64_r64', '-1', 'cmpq_r64_r64')
  {302,-1,470},//('cmovel_r32_r32', '-1', 'cmpl_r32_imm8')
  {137,0,2461},//('andq_r64_imm8', '0', 'subq_r64_r64')
  {476,0,70},//('cmpq_r64_m64', '0', 'addq_r64_imm8')
  {475,0,2170},//('cmpq_r64_imm8', '0', 'sarq_r64_one')
  {72,1,280},//('addq_r64_r64', '1', 'cmovaeq_r64_r64')
  {2251,-1,2506},//('setg_r8', '-1', 'testl_r32_r32')
  {70,0,1453},//('addq_r64_imm8', '0', 'orq_r64_r64')
  {2510,0,2251},//('testb_r8_r8', '0', 'setg_r8')
  {2510,1,2236},//('testb_r8_r8', '1', 'setae_r8')
  {2469,0,72},//('subq_rax_imm32', '0', 'addq_r64_r64')
  {290,-1,470},//('cmovbel_r32_r32', '-1', 'cmpl_r32_imm8')
  {2236,-1,477},//('setae_r8', '-1', 'cmpq_r64_r64')
  {272,-1,470},//('cmoval_r32_r32', '-1', 'cmpl_r32_imm8')
  {364,1,1134},//('cmovneq_r64_r64', '1', 'leaq_r64_m16')
  {2461,0,2343},//('subq_r64_r64', '0', 'shlq_r64_one')
  {2248,-1,453},//('sete_r8', '-1', 'cmpw_m16_imm8')
  {828,1,2169},//('imulq_r64_r64', '1', 'sarq_r64_imm8')
  {2169,0,406},//('sarq_r64_imm8', '0', 'cmovnsq_r64_r64')
  {2251,-1,470},//('setg_r8', '-1', 'cmpl_r32_imm8')
  {2510,1,2251},//('testb_r8_r8', '1', 'setg_r8')
  {304,-1,477},//('cmoveq_r64_r64', '-1', 'cmpq_r64_r64')
  {139,0,828},//('andq_r64_r64', '0', 'imulq_r64_r64')
  {2510,1,2248},//('testb_r8_r8', '1', 'sete_r8')
  {2248,-1,2508},//('sete_r8', '-1', 'testq_r64_r64')
  {302,-1,2506},//('cmovel_r32_r32', '-1', 'testl_r32_r32')
  {22,-1,470},//('adcl_r32_imm8', '-1', 'cmpl_r32_imm8')
  {2510,0,2257},//('testb_r8_r8', '0', 'setl_r8')
  {2386,0,2461},//('shrq_r64_one', '0', 'subq_r64_r64')
  {2461,1,274},//('subq_r64_r64', '1', 'cmovaq_r64_r64')
  {2278,-1,470},//('setne_r8', '-1', 'cmpl_r32_imm8')
  {322,-1,477},//('cmovlq_r64_r64', '-1', 'cmpq_r64_r64')
  {72,1,2458},//('addq_r64_r64', '1', 'subq_r64_imm32')
  {1422,0,2385},//('notq_r64', '0', 'shrq_r64_imm8')
  {292,1,2342},//('cmovbeq_r64_r64', '1', 'shlq_r64_imm8')
  {304,-1,2510},//('cmoveq_r64_r64', '-1', 'testb_r8_r8')
  {3833,0,1453},//('xorq_r64_r64', '0', 'orq_r64_r64')
  {845,0,2461},//('incq_r64', '0', 'subq_r64_r64')
  {272,-1,472},//('cmoval_r32_r32', '-1', 'cmpl_r32_r32')
  {72,1,1134},//('addq_r64_r64', '1', 'leaq_r64_m16')
  {328,-1,475},//('cmovleq_r64_r64', '-1', 'cmpq_r64_imm8')
  {403,-1,2506},//('cmovnsl_r32_m32', '-1', 'testl_r32_r32')
  {72,1,2385},//('addq_r64_r64', '1', 'shrq_r64_imm8')
  {2510,1,2257},//('testb_r8_r8', '1', 'setl_r8')
  {2385,0,2461},//('shrq_r64_imm8', '0', 'subq_r64_r64')
  {137,0,1134},//('andq_r64_imm8', '0', 'leaq_r64_m16')
  {1453,1,2454},//('orq_r64_r64', '1', 'subl_r32_imm8')
  {322,-1,472},//('cmovlq_r64_r64', '-1', 'cmpl_r32_r32')
  {304,-1,2509},//('cmoveq_r64_r64', '-1', 'testb_r8_imm8')
  {137,0,2209},//('andq_r64_imm8', '0', 'sbbq_r64_r64')
  {406,-1,2508},//('cmovnsq_r64_r64', '-1', 'testq_r64_r64')
  {364,-1,461},//('cmovneq_r64_r64', '-1', 'cmpb_m8_imm8')
  {326,-1,470},//('cmovlel_r32_r32', '-1', 'cmpl_r32_imm8')
  {3832,0,2385},//('xorq_r64_m64', '0', 'shrq_r64_imm8')
  {477,0,2461},//('cmpq_r64_r64', '0', 'subq_r64_r64')
  {2257,-1,477},//('setl_r8', '-1', 'cmpq_r64_r64')
  {2248,-1,451},//('sete_r8', '-1', 'cmpl_eax_imm32')
  {1408,0,2342},//('negq_r64', '0', 'shlq_r64_imm8')
  {2233,-1,470},//('seta_r8', '-1', 'cmpl_r32_imm8')
  {304,-1,459},//('cmoveq_r64_r64', '-1', 'cmpq_m64_imm8')
  {70,0,1134},//('addq_r64_imm8', '0', 'leaq_r64_m16')
  {2342,0,1134},//('shlq_r64_imm8', '0', 'leaq_r64_m16')
  {2461,0,2342},//('subq_r64_r64', '0', 'shlq_r64_imm8')
  {476,0,1134},//('cmpq_r64_m64', '0', 'leaq_r64_m16')
  {1453,0,2342},//('orq_r64_r64', '0', 'shlq_r64_imm8')
  {362,-1,2510},//('cmovnel_r32_r32', '-1', 'testb_r8_r8')
  {362,-1,461},//('cmovnel_r32_r32', '-1', 'cmpb_m8_imm8')
  {2201,-1,470},//('sbbl_r32_imm32', '-1', 'cmpl_r32_imm8')
  {364,-1,2510},//('cmovneq_r64_r64', '-1', 'testb_r8_r8')
  {362,-1,2509},//('cmovnel_r32_r32', '-1', 'testb_r8_imm8')
  {301,-1,2506},//('cmovel_r32_m32', '-1', 'testl_r32_r32')
  {2379,0,2379},//('shrw_r16_imm8', '0', 'shrw_r16_imm8')
  {2508,1,137},//('testq_r64_r64', '1', 'andq_r64_imm8')
  {2508,0,137},//('testq_r64_r64', '0', 'andq_r64_imm8')
  {2461,0,3832},//('subq_r64_r64', '0', 'xorq_r64_m64')
  {303,-1,2508},//('cmoveq_r64_m64', '-1', 'testq_r64_r64')
  {2257,-1,460},//('setl_r8', '-1', 'cmpq_m64_r64')
  {2247,-1,470},//('sete_m8', '-1', 'cmpl_r32_imm8')
  {442,-1,72},//('cmovsq_r64_r64', '-1', 'addq_r64_r64')
  {2248,-1,469},//('sete_r8', '-1', 'cmpl_r32_imm32')
  {2242,-1,472},//('setbe_r8', '-1', 'cmpl_r32_r32')
  {442,-1,2506},//('cmovsq_r64_r64', '-1', 'testl_r32_r32')
  {1453,1,2341},//('orq_r64_r64', '1', 'shlq_r64_cl')
  {362,-1,479},//('cmovnel_r32_r32', '-1', 'cmpb_r8_imm8')
  {442,-1,2508},//('cmovsq_r64_r64', '-1', 'testq_r64_r64')
  {3833,1,1134},//('xorq_r64_r64', '1', 'leaq_r64_m16')
  {2461,0,1134},//('subq_r64_r64', '0', 'leaq_r64_m16')
  {1453,0,2170},//('orq_r64_r64', '0', 'sarq_r64_one')
  {2248,-1,458},//('sete_r8', '-1', 'cmpq_m64_imm32')
  {278,-1,472},//('cmovael_r32_r32', '-1', 'cmpl_r32_r32')
  {72,0,2068},//('addq_r64_r64', '0', 'roll_r32_imm8')
  {2248,-1,476},//('sete_r8', '-1', 'cmpq_r64_m64')
  {71,0,2461},//('addq_r64_m64', '0', 'subq_r64_r64')
  {2508,0,1134},//('testq_r64_r64', '0', 'leaq_r64_m16')
  {477,1,2170},//('cmpq_r64_r64', '1', 'sarq_r64_one')
  {2508,1,1134},//('testq_r64_r64', '1', 'leaq_r64_m16')
  {406,-1,461},//('cmovnsq_r64_r64', '-1', 'cmpb_m8_imm8')
  {1451,0,2385},//('orq_r64_imm8', '0', 'shrq_r64_imm8')
  {828,0,3833},//('imulq_r64_r64', '0', 'xorq_r64_r64')
  {72,1,263},//('addq_r64_r64', '1', 'cltq')
  {2204,-1,461},//('sbbl_r32_r32', '-1', 'cmpb_m8_imm8')
  {303,-1,2506},//('cmoveq_r64_m64', '-1', 'testl_r32_r32')
  {69,0,2458},//('addq_r64_imm32', '0', 'subq_r64_imm32')
  {2278,-1,477},//('setne_r8', '-1', 'cmpq_r64_r64')
  {55,1,2342},//('addq_m64_r64', '1', 'shlq_r64_imm8')
  {2209,-1,449},//('sbbq_r64_r64', '-1', 'cmpb_al_imm8')
  {2248,-1,477},//('sete_r8', '-1', 'cmpq_r64_r64')
  {1453,1,132},//('orq_r64_r64', '1', 'andl_r32_imm8')
  {72,0,1134},//('addq_r64_r64', '0', 'leaq_r64_m16')
  {2169,0,828},//('sarq_r64_imm8', '0', 'imulq_r64_r64')
  {477,0,72},//('cmpq_r64_r64', '0', 'addq_r64_r64')
  {302,-1,461},//('cmovel_r32_r32', '-1', 'cmpb_m8_imm8')
  {404,-1,2454},//('cmovnsl_r32_r32', '-1', 'subl_r32_imm8')
  {475,0,2098},//('cmpq_r64_imm8', '0', 'rorq_r64_imm8')
  {2169,0,442},//('sarq_r64_imm8', '0', 'cmovsq_r64_r64')
  {2461,0,2169},//('subq_r64_r64', '0', 'sarq_r64_imm8')
  {72,1,72},//('addq_r64_r64', '1', 'addq_r64_r64')
  {2254,-1,477},//('setge_r8', '-1', 'cmpq_r64_r64')
  {362,-1,470},//('cmovnel_r32_r32', '-1', 'cmpl_r32_imm8')
  {80,0,1134},//('addq_rax_imm32', '0', 'leaq_r64_m16')
  {2461,1,1134},//('subq_r64_r64', '1', 'leaq_r64_m16')
  {406,-1,2506},//('cmovnsq_r64_r64', '-1', 'testl_r32_r32')
  {2278,-1,461},//('setne_r8', '-1', 'cmpb_m8_imm8')
  {1408,0,263},//('negq_r64', '0', 'cltq')
  {2251,-1,477},//('setg_r8', '-1', 'cmpq_r64_r64')
  {2510,1,2233},//('testb_r8_r8', '1', 'seta_r8')
  {2209,-1,475},//('sbbq_r64_r64', '-1', 'cmpq_r64_imm8')
  {303,-1,461},//('cmoveq_r64_m64', '-1', 'cmpb_m8_imm8')
  {825,0,2461},//('imulq_r64_m64', '0', 'subq_r64_r64')
  {2251,-1,472},//('setg_r8', '-1', 'cmpl_r32_r32')
  {2278,-1,456},//('setne_r8', '-1', 'cmpl_m32_imm8')
  {72,0,2169},//('addq_r64_r64', '0', 'sarq_r64_imm8')
  {1453,1,2170},//('orq_r64_r64', '1', 'sarq_r64_one')
  {55,1,1131},//('addq_m64_r64', '1', 'leal_r32_m16')
  {2251,-1,456},//('setg_r8', '-1', 'cmpl_m32_imm8')
  {2247,-1,461},//('sete_m8', '-1', 'cmpb_m8_imm8')
  {2459,0,2342},//('subq_r64_imm8', '0', 'shlq_r64_imm8')
  {2247,-1,2506},//('sete_m8', '-1', 'testl_r32_r32')
  {485,0,70},//('cmpq_rax_imm32', '0', 'addq_r64_imm8')
  {477,0,2169},//('cmpq_r64_r64', '0', 'sarq_r64_imm8')
  {137,0,70},//('andq_r64_imm8', '0', 'addq_r64_imm8')
  {2278,-1,469},//('setne_r8', '-1', 'cmpl_r32_imm32')
  {2277,-1,2506},//('setne_m8', '-1', 'testl_r32_r32')
  {2260,-1,470},//('setle_r8', '-1', 'cmpl_r32_imm8')
  {475,0,70},//('cmpq_r64_imm8', '0', 'addq_r64_imm8')
  {2204,-1,475},//('sbbl_r32_r32', '-1', 'cmpq_r64_imm8')
  {2248,-1,465},//('sete_r8', '-1', 'cmpw_r16_imm8')
  {364,-1,2509},//('cmovneq_r64_r64', '-1', 'testb_r8_imm8')
  {2277,-1,2508},//('setne_m8', '-1', 'testq_r64_r64')
  {310,-1,472},//('cmovgq_r64_r64', '-1', 'cmpl_r32_r32')
  {1453,1,1131},//('orq_r64_r64', '1', 'leal_r32_m16')
  {362,-1,449},//('cmovnel_r32_r32', '-1', 'cmpb_al_imm8')
  {2248,-1,455},//('sete_r8', '-1', 'cmpl_m32_imm32')
  {2248,-1,459},//('sete_r8', '-1', 'cmpq_m64_imm8')
  {1453,0,1453},//('orq_r64_r64', '0', 'orq_r64_r64')
  {72,0,2385},//('addq_r64_r64', '0', 'shrq_r64_imm8')
  {2510,0,2233},//('testb_r8_r8', '0', 'seta_r8')
  {2278,-1,451},//('setne_r8', '-1', 'cmpl_eax_imm32')
  {1453,1,70},//('orq_r64_r64', '1', 'addq_r64_imm8')
  {1453,0,2341},//('orq_r64_r64', '0', 'shlq_r64_cl')
  {449,0,2388},//('cmpb_al_imm8', '0', 'shrb_r8_imm8')
  {477,1,80},//('cmpq_r64_r64', '1', 'addq_rax_imm32')
  {364,-1,2506},//('cmovneq_r64_r64', '-1', 'testl_r32_r32')
  {326,-1,2506},//('cmovlel_r32_r32', '-1', 'testl_r32_r32')
  {361,-1,2506},//('cmovnel_r32_m32', '-1', 'testl_r32_r32')
  {363,-1,2506},//('cmovneq_r64_m64', '-1', 'testl_r32_r32')
  {2248,-1,457},//('sete_r8', '-1', 'cmpl_m32_r32')
  {477,1,71},//('cmpq_r64_r64', '1', 'addq_r64_m64')
  {70,0,1922},//('addq_r64_imm8', '0', 'pushq_m64')
  {2491,0,2388},//('testb_al_imm8', '0', 'shrb_r8_imm8')
  {364,-1,2491},//('cmovneq_r64_r64', '-1', 'testb_al_imm8')
  {2385,0,70},//('shrq_r64_imm8', '0', 'addq_r64_imm8')
  {3833,1,2169},//('xorq_r64_r64', '1', 'sarq_r64_imm8')
  {286,-1,475},//('cmovbq_r64_r64', '-1', 'cmpq_r64_imm8')
  {2248,-1,450},//('sete_r8', '-1', 'cmpw_ax_imm16')
  {830,1,2382},//('imulq_r64_r64_imm8', '1', 'shrl_r32_imm8')
  {364,-1,477},//('cmovneq_r64_r64', '-1', 'cmpq_r64_r64')
  {72,0,137},//('addq_r64_r64', '0', 'andq_r64_imm8')
  {2461,1,70},//('subq_r64_r64', '1', 'addq_r64_imm8')
  {442,-1,2461},//('cmovsq_r64_r64', '-1', 'subq_r64_r64')
  {70,0,828},//('addq_r64_imm8', '0', 'imulq_r64_r64')
  {2461,1,71},//('subq_r64_r64', '1', 'addq_r64_m64')
  {304,-1,470},//('cmoveq_r64_r64', '-1', 'cmpl_r32_imm8')
  {475,0,2169},//('cmpq_r64_imm8', '0', 'sarq_r64_imm8')
  {55,1,1134},//('addq_m64_r64', '1', 'leaq_r64_m16')
  {72,1,137},//('addq_r64_r64', '1', 'andq_r64_imm8')
  {485,0,2460},//('cmpq_rax_imm32', '0', 'subq_r64_m64')
  {2098,0,72},//('rorq_r64_imm8', '0', 'addq_r64_r64')
  {72,0,828},//('addq_r64_r64', '0', 'imulq_r64_r64')
  {477,1,69},//('cmpq_r64_r64', '1', 'addq_r64_imm32')
  {828,0,2385},//('imulq_r64_r64', '0', 'shrq_r64_imm8')
  {2248,-1,472},//('sete_r8', '-1', 'cmpl_r32_r32')
  {2508,1,803},//('testq_r64_r64', '1', 'idivq_r64')
  {2508,0,803},//('testq_r64_r64', '0', 'idivq_r64')
  {302,-1,2510},//('cmovel_r32_r32', '-1', 'testb_r8_r8')
  {72,0,1422},//('addq_r64_r64', '0', 'notq_r64')
  {475,0,132},//('cmpq_r64_imm8', '0', 'andl_r32_imm8')
  {286,-1,470},//('cmovbq_r64_r64', '-1', 'cmpl_r32_imm8')
  {477,0,828},//('cmpq_r64_r64', '0', 'imulq_r64_r64')
  {460,1,1134},//('cmpq_m64_r64', '1', 'leaq_r64_m16')
  {274,1,2461},//('cmovaq_r64_r64', '1', 'subq_r64_r64')
  {71,0,263},//('addq_r64_m64', '0', 'cltq')
  {364,-1,475},//('cmovneq_r64_r64', '-1', 'cmpq_r64_imm8')
  {1451,0,137},//('orq_r64_imm8', '0', 'andq_r64_imm8')
  {2461,1,828},//('subq_r64_r64', '1', 'imulq_r64_r64')
  {274,-1,470},//('cmovaq_r64_r64', '-1', 'cmpl_r32_imm8')
  {362,-1,472},//('cmovnel_r32_r32', '-1', 'cmpl_r32_r32')
  {72,1,3833},//('addq_r64_r64', '1', 'xorq_r64_r64')
  {72,0,2459},//('addq_r64_r64', '0', 'subq_r64_imm8')
  {477,0,2385},//('cmpq_r64_r64', '0', 'shrq_r64_imm8')
  {72,0,2461},//('addq_r64_r64', '0', 'subq_r64_r64')
  {72,1,71},//('addq_r64_r64', '1', 'addq_r64_m64')
  {2508,0,132},//('testq_r64_r64', '0', 'andl_r32_imm8')
  {2170,0,1451},//('sarq_r64_one', '0', 'orq_r64_imm8')
  {2508,1,132},//('testq_r64_r64', '1', 'andl_r32_imm8')
  {72,0,824},//('addq_r64_r64', '0', 'imulq_r64')
  {2251,-1,475},//('setg_r8', '-1', 'cmpq_r64_imm8')
  {2342,0,67},//('shlq_r64_imm8', '0', 'addl_r32_r32')
  {2260,-1,2508},//('setle_r8', '-1', 'testq_r64_r64')
  {302,-1,472},//('cmovel_r32_r32', '-1', 'cmpl_r32_r32')
  {474,0,70},//('cmpq_r64_imm32', '0', 'addq_r64_imm8')
  {2233,-1,477},//('seta_r8', '-1', 'cmpq_r64_r64')
  {2260,-1,2506},//('setle_r8', '-1', 'testl_r32_r32')
  {72,1,2469},//('addq_r64_r64', '1', 'subq_rax_imm32')
  {3833,1,2459},//('xorq_r64_r64', '1', 'subq_r64_imm8')
  {71,0,71},//('addq_r64_m64', '0', 'addq_r64_m64')
  {2461,1,263},//('subq_r64_r64', '1', 'cltq')
  {477,1,1453},//('cmpq_r64_r64', '1', 'orq_r64_r64')
  {1453,0,131},//('orq_r64_r64', '0', 'andl_r32_imm32')
  {328,-1,2508},//('cmovleq_r64_r64', '-1', 'testq_r64_r64')
  {460,1,71},//('cmpq_m64_r64', '1', 'addq_r64_m64')
  {71,0,137},//('addq_r64_m64', '0', 'andq_r64_imm8')
  {1453,1,131},//('orq_r64_r64', '1', 'andl_r32_imm32')
  {308,-1,2506},//('cmovgl_r32_r32', '-1', 'testl_r32_r32')
  {2385,0,2460},//('shrq_r64_imm8', '0', 'subq_r64_m64')
  {475,0,2459},//('cmpq_r64_imm8', '0', 'subq_r64_imm8')
  {322,1,1134},//('cmovlq_r64_r64', '1', 'leaq_r64_m16')
  {477,0,310},//('cmpq_r64_r64', '0', 'cmovgq_r64_r64')
  {2278,-1,449},//('setne_r8', '-1', 'cmpb_al_imm8')
  {137,0,1451},//('andq_r64_imm8', '0', 'orq_r64_imm8')
  {308,-1,470},//('cmovgl_r32_r32', '-1', 'cmpl_r32_imm8')
  {475,0,2460},//('cmpq_r64_imm8', '0', 'subq_r64_m64')
  {72,1,830},//('addq_r64_r64', '1', 'imulq_r64_r64_imm8')
  {72,1,829},//('addq_r64_r64', '1', 'imulq_r64_r64_imm32')
  {2508,0,292},//('testq_r64_r64', '0', 'cmovbeq_r64_r64')
  {2508,1,292},//('testq_r64_r64', '1', 'cmovbeq_r64_r64')
  {2278,-1,455},//('setne_r8', '-1', 'cmpl_m32_imm32')
  {477,0,1453},//('cmpq_r64_r64', '0', 'orq_r64_r64')
  {364,-1,470},//('cmovneq_r64_r64', '-1', 'cmpl_r32_imm8')
  {362,-1,459},//('cmovnel_r32_r32', '-1', 'cmpq_m64_imm8')
  {2508,0,2459},//('testq_r64_r64', '0', 'subq_r64_imm8')
  {2508,1,2459},//('testq_r64_r64', '1', 'subq_r64_imm8')
  {71,0,828},//('addq_r64_m64', '0', 'imulq_r64_r64')
  {477,1,2459},//('cmpq_r64_r64', '1', 'subq_r64_imm8')
  {70,0,2169},//('addq_r64_imm8', '0', 'sarq_r64_imm8')
  {2510,0,2388},//('testb_r8_r8', '0', 'shrb_r8_imm8')
  {2510,1,2388},//('testb_r8_r8', '1', 'shrb_r8_imm8')
  {1408,0,1134},//('negq_r64', '0', 'leaq_r64_m16')
  {475,0,2385},//('cmpq_r64_imm8', '0', 'shrq_r64_imm8')
  {2461,0,1453},//('subq_r64_r64', '0', 'orq_r64_r64')
  {362,-1,2508},//('cmovnel_r32_r32', '-1', 'testq_r64_r64')
  {70,0,2209},//('addq_r64_imm8', '0', 'sbbq_r64_r64')
  {477,0,69},//('cmpq_r64_r64', '0', 'addq_r64_imm32')
  {2248,-1,475},//('sete_r8', '-1', 'cmpq_r64_imm8')
  {477,1,1422},//('cmpq_r64_r64', '1', 'notq_r64')
  {308,-1,477},//('cmovgl_r32_r32', '-1', 'cmpq_r64_r64')
  {2342,0,2454},//('shlq_r64_imm8', '0', 'subl_r32_imm8')
  {2278,-1,2500},//('setne_r8', '-1', 'testb_m8_imm8')
  {2204,-1,459},//('sbbl_r32_r32', '-1', 'cmpq_m64_imm8')
  {477,0,328},//('cmpq_r64_r64', '0', 'cmovleq_r64_r64')
  {476,0,71},//('cmpq_r64_m64', '0', 'addq_r64_m64')
  {477,1,328},//('cmpq_r64_r64', '1', 'cmovleq_r64_r64')
  {485,0,1134},//('cmpq_rax_imm32', '0', 'leaq_r64_m16')
  {477,1,803},//('cmpq_r64_r64', '1', 'idivq_r64')
  {2508,1,2385},//('testq_r64_r64', '1', 'shrq_r64_imm8')
  {72,1,2459},//('addq_r64_r64', '1', 'subq_r64_imm8')
  {2508,0,2385},//('testq_r64_r64', '0', 'shrq_r64_imm8')
  {2278,-1,460},//('setne_r8', '-1', 'cmpq_m64_r64')
  {2278,-1,471},//('setne_r8', '-1', 'cmpl_r32_m32')
  {2170,0,2461},//('sarq_r64_one', '0', 'subq_r64_r64')
  {2385,0,67},//('shrq_r64_imm8', '0', 'addl_r32_r32')
  {2278,-1,479},//('setne_r8', '-1', 'cmpb_r8_imm8')
  {328,1,1134},//('cmovleq_r64_r64', '1', 'leaq_r64_m16')
  {274,1,1134},//('cmovaq_r64_r64', '1', 'leaq_r64_m16')
  {71,0,1134},//('addq_r64_m64', '0', 'leaq_r64_m16')
  {2247,-1,2508},//('sete_m8', '-1', 'testq_r64_r64')
  {1453,0,137},//('orq_r64_r64', '0', 'andq_r64_imm8')
  {477,1,2385},//('cmpq_r64_r64', '1', 'shrq_r64_imm8')
  {2342,0,2460},//('shlq_r64_imm8', '0', 'subq_r64_m64')
  {2278,-1,2510},//('setne_r8', '-1', 'testb_r8_r8')
  {442,1,3828},//('cmovsq_r64_r64', '1', 'xorl_r32_r32')
  {2242,-1,477},//('setbe_r8', '-1', 'cmpq_r64_r64')
  {72,1,828},//('addq_r64_r64', '1', 'imulq_r64_r64')
  {2251,-1,2508},//('setg_r8', '-1', 'testq_r64_r64')
  {477,0,71},//('cmpq_r64_r64', '0', 'addq_r64_m64')
  {2278,-1,476},//('setne_r8', '-1', 'cmpq_r64_m64')
  {364,-1,2500},//('cmovneq_r64_r64', '-1', 'testb_m8_imm8')
  {475,0,828},//('cmpq_r64_imm8', '0', 'imulq_r64_r64')
  {72,1,2461},//('addq_r64_r64', '1', 'subq_r64_r64')
  {477,1,137},//('cmpq_r64_r64', '1', 'andq_r64_imm8')
  {1453,0,72},//('orq_r64_r64', '0', 'addq_r64_r64')
  {2169,0,2342},//('sarq_r64_imm8', '0', 'shlq_r64_imm8')
  {2385,0,2342},//('shrq_r64_imm8', '0', 'shlq_r64_imm8')
  {477,0,2459},//('cmpq_r64_r64', '0', 'subq_r64_imm8')
  {304,-1,132},//('cmoveq_r64_r64', '-1', 'andl_r32_imm8')
  {304,1,137},//('cmoveq_r64_r64', '1', 'andq_r64_imm8')
  {460,1,2461},//('cmpq_m64_r64', '1', 'subq_r64_r64')
  {406,1,1134},//('cmovnsq_r64_r64', '1', 'leaq_r64_m16')
  {2239,-1,477},//('setb_r8', '-1', 'cmpq_r64_r64')
  {72,1,2169},//('addq_r64_r64', '1', 'sarq_r64_imm8')
  {2248,-1,474},//('sete_r8', '-1', 'cmpq_r64_imm32')
  {364,-1,460},//('cmovneq_r64_r64', '-1', 'cmpq_m64_r64')
  {292,1,2461},//('cmovbeq_r64_r64', '1', 'subq_r64_r64')
  {139,0,72},//('andq_r64_r64', '0', 'addq_r64_r64')
  {2508,1,328},//('testq_r64_r64', '1', 'cmovleq_r64_r64')
  {2508,0,328},//('testq_r64_r64', '0', 'cmovleq_r64_r64')
  {2342,0,69},//('shlq_r64_imm8', '0', 'addq_r64_imm32')
  {477,0,2170},//('cmpq_r64_r64', '0', 'sarq_r64_one')
  {2278,-1,472},//('setne_r8', '-1', 'cmpl_r32_r32')
  {137,0,1453},//('andq_r64_imm8', '0', 'orq_r64_r64')
  {70,0,2460},//('addq_r64_imm8', '0', 'subq_r64_m64')
  {2342,0,2385},//('shlq_r64_imm8', '0', 'shrq_r64_imm8')
  {302,-1,2508},//('cmovel_r32_r32', '-1', 'testq_r64_r64')
  {475,0,1134},//('cmpq_r64_imm8', '0', 'leaq_r64_m16')
  {475,0,364},//('cmpq_r64_imm8', '0', 'cmovneq_r64_r64')
  {2459,0,2169},//('subq_r64_imm8', '0', 'sarq_r64_imm8')
  {70,0,71},//('addq_r64_imm8', '0', 'addq_r64_m64')
  {442,1,1134},//('cmovsq_r64_r64', '1', 'leaq_r64_m16')
  {2461,0,71},//('subq_r64_r64', '0', 'addq_r64_m64')
  {69,0,1926},//('addq_r64_imm32', '0', 'pushq_r64_1')
  {2248,-1,2510},//('sete_r8', '-1', 'testb_r8_r8')
  {304,-1,479},//('cmoveq_r64_r64', '-1', 'cmpb_r8_imm8')
  {55,1,72},//('addq_m64_r64', '1', 'addq_r64_r64')
  {304,-1,449},//('cmoveq_r64_r64', '-1', 'cmpb_al_imm8')
  {2508,0,2461},//('testq_r64_r64', '0', 'subq_r64_r64')
  {2508,1,2461},//('testq_r64_r64', '1', 'subq_r64_r64')
  {362,-1,477},//('cmovnel_r32_r32', '-1', 'cmpq_r64_r64')
  {460,1,69},//('cmpq_m64_r64', '1', 'addq_r64_imm32')
  {70,0,1422},//('addq_r64_imm8', '0', 'notq_r64')
  {2461,1,2461},//('subq_r64_r64', '1', 'subq_r64_r64')
  {2459,0,2461},//('subq_r64_imm8', '0', 'subq_r64_r64')
  {1453,1,72},//('orq_r64_r64', '1', 'addq_r64_r64')
  {2278,-1,475},//('setne_r8', '-1', 'cmpq_r64_imm8')
  {80,0,72},//('addq_rax_imm32', '0', 'addq_r64_r64')
  {72,0,71},//('addq_r64_r64', '0', 'addq_r64_m64')
  {477,0,137},//('cmpq_r64_r64', '0', 'andq_r64_imm8')
  {71,0,72},//('addq_r64_m64', '0', 'addq_r64_r64')
  {2461,1,72},//('subq_r64_r64', '1', 'addq_r64_r64')
  {2170,0,1134},//('sarq_r64_one', '0', 'leaq_r64_m16')
  {477,1,2460},//('cmpq_r64_r64', '1', 'subq_r64_m64')
  {304,1,3828},//('cmoveq_r64_r64', '1', 'xorl_r32_r32')
  {2461,0,2461},//('subq_r64_r64', '0', 'subq_r64_r64')
  {2459,0,71},//('subq_r64_imm8', '0', 'addq_r64_m64')
  {137,0,2460},//('andq_r64_imm8', '0', 'subq_r64_m64')
  {304,-1,475},//('cmoveq_r64_r64', '-1', 'cmpq_r64_imm8')
  {2342,0,2169},//('shlq_r64_imm8', '0', 'sarq_r64_imm8')
  {72,0,1453},//('addq_r64_r64', '0', 'orq_r64_r64')
  {304,1,70},//('cmoveq_r64_r64', '1', 'addq_r64_imm8')
  {476,0,263},//('cmpq_r64_m64', '0', 'cltq')
  {69,0,2342},//('addq_r64_imm32', '0', 'shlq_r64_imm8')
  {2461,1,2385},//('subq_r64_r64', '1', 'shrq_r64_imm8')
  {137,0,137},//('andq_r64_imm8', '0', 'andq_r64_imm8')
  {137,0,1762},//('andq_r64_imm8', '0', 'popq_r64_1')
  {139,0,1134},//('andq_r64_r64', '0', 'leaq_r64_m16')
  {2508,0,2460},//('testq_r64_r64', '0', 'subq_r64_m64')
  {2508,1,2460},//('testq_r64_r64', '1', 'subq_r64_m64')
  {364,1,2342},//('cmovneq_r64_r64', '1', 'shlq_r64_imm8')
  {72,0,2458},//('addq_r64_r64', '0', 'subq_r64_imm32')
  {2461,0,70},//('subq_r64_r64', '0', 'addq_r64_imm8')
  {2342,0,131},//('shlq_r64_imm8', '0', 'andl_r32_imm32')
  {2342,0,132},//('shlq_r64_imm8', '0', 'andl_r32_imm8')
  {70,0,2461},//('addq_r64_imm8', '0', 'subq_r64_r64')
  {476,0,69},//('cmpq_r64_m64', '0', 'addq_r64_imm32')
  {477,1,364},//('cmpq_r64_r64', '1', 'cmovneq_r64_r64')
  {2508,0,2341},//('testq_r64_r64', '0', 'shlq_r64_cl')
  {364,1,72},//('cmovneq_r64_r64', '1', 'addq_r64_r64')
  {72,0,1131},//('addq_r64_r64', '0', 'leal_r32_m16')
  {476,0,72},//('cmpq_r64_m64', '0', 'addq_r64_r64')
  {364,1,70},//('cmovneq_r64_r64', '1', 'addq_r64_imm8')
  {2508,0,71},//('testq_r64_r64', '0', 'addq_r64_m64')
  {2508,1,71},//('testq_r64_r64', '1', 'addq_r64_m64')
  {72,0,67},//('addq_r64_r64', '0', 'addl_r32_r32')
  {72,0,2460},//('addq_r64_r64', '0', 'subq_r64_m64')
  {70,0,2385},//('addq_r64_imm8', '0', 'shrq_r64_imm8')
  {2461,0,72},//('subq_r64_r64', '0', 'addq_r64_r64')
  {70,0,2454},//('addq_r64_imm8', '0', 'subl_r32_imm8')
  {2342,0,2461},//('shlq_r64_imm8', '0', 'subq_r64_r64')
  {477,1,263},//('cmpq_r64_r64', '1', 'cltq')
  {364,1,3828},//('cmovneq_r64_r64', '1', 'xorl_r32_r32')
  {2342,0,1131},//('shlq_r64_imm8', '0', 'leal_r32_m16')
  {477,1,2458},//('cmpq_r64_r64', '1', 'subq_r64_imm32')
  {72,0,132},//('addq_r64_r64', '0', 'andl_r32_imm8')
  {477,0,263},//('cmpq_r64_r64', '0', 'cltq')
  {70,0,1451},//('addq_r64_imm8', '0', 'orq_r64_imm8')
  {477,0,364},//('cmpq_r64_r64', '0', 'cmovneq_r64_r64')
  {292,1,1134},//('cmovbeq_r64_r64', '1', 'leaq_r64_m16')
  {70,0,2342},//('addq_r64_imm8', '0', 'shlq_r64_imm8')
  {460,1,2459},//('cmpq_m64_r64', '1', 'subq_r64_imm8')
  {2342,0,2456},//('shlq_r64_imm8', '0', 'subl_r32_r32')
  {72,1,3828},//('addq_r64_r64', '1', 'xorl_r32_r32')
  {2385,0,72},//('shrq_r64_imm8', '0', 'addq_r64_r64')
  {2385,0,1134},//('shrq_r64_imm8', '0', 'leaq_r64_m16')
  {2169,0,72},//('sarq_r64_imm8', '0', 'addq_r64_r64')
  {72,1,2456},//('addq_r64_r64', '1', 'subl_r32_r32')
  {72,0,3828},//('addq_r64_r64', '0', 'xorl_r32_r32')
  {2461,0,2459},//('subq_r64_r64', '0', 'subq_r64_imm8')
  {70,0,70},//('addq_r64_imm8', '0', 'addq_r64_imm8')
  {70,0,1762},//('addq_r64_imm8', '0', 'popq_r64_1')
  {72,1,132},//('addq_r64_r64', '1', 'andl_r32_imm8')
  {72,0,70},//('addq_r64_r64', '0', 'addq_r64_imm8')
  {475,0,72},//('cmpq_r64_imm8', '0', 'addq_r64_r64')
  {2508,1,263},//('testq_r64_r64', '1', 'cltq')
  {2508,0,263},//('testq_r64_r64', '0', 'cltq')
  {70,0,137},//('addq_r64_imm8', '0', 'andq_r64_imm8')
  {2170,0,70},//('sarq_r64_one', '0', 'addq_r64_imm8')
  {2169,0,1134},//('sarq_r64_imm8', '0', 'leaq_r64_m16')
  {2508,0,72},//('testq_r64_r64', '0', 'addq_r64_r64')
  {2508,1,72},//('testq_r64_r64', '1', 'addq_r64_r64')
  {2508,0,304},//('testq_r64_r64', '0', 'cmoveq_r64_r64')
  {2508,1,304},//('testq_r64_r64', '1', 'cmoveq_r64_r64')
  {70,0,72},//('addq_r64_imm8', '0', 'addq_r64_r64')
  {1453,1,1134},//('orq_r64_r64', '1', 'leaq_r64_m16')
  {1926,0,1926},//('pushq_r64_1', '0', 'pushq_r64_1')
  {460,1,72},//('cmpq_m64_r64', '1', 'addq_r64_r64')
  {72,0,2382},//('addq_r64_r64', '0', 'shrl_r32_imm8')
  {1453,1,3828},//('orq_r64_r64', '1', 'xorl_r32_r32')
  {2461,0,132},//('subq_r64_r64', '0', 'andl_r32_imm8')
  {72,1,2382},//('addq_r64_r64', '1', 'shrl_r32_imm8')
  {2342,0,3828},//('shlq_r64_imm8', '0', 'xorl_r32_r32')
  {828,0,1134},//('imulq_r64_r64', '0', 'leaq_r64_m16')
  {72,1,70},//('addq_r64_r64', '1', 'addq_r64_imm8')
  {70,0,3828},//('addq_r64_imm8', '0', 'xorl_r32_r32')
  {70,0,1131},//('addq_r64_imm8', '0', 'leal_r32_m16')
  {70,0,132},//('addq_r64_imm8', '0', 'andl_r32_imm8')
  {2342,0,2459},//('shlq_r64_imm8', '0', 'subq_r64_imm8')
  {477,0,1131},//('cmpq_r64_r64', '0', 'leal_r32_m16')
  {2460,0,1134},//('subq_r64_m64', '0', 'leaq_r64_m16')
  {2461,1,3828},//('subq_r64_r64', '1', 'xorl_r32_r32')
  {2459,0,2459},//('subq_r64_imm8', '0', 'subq_r64_imm8')
  {477,1,2342},//('cmpq_r64_r64', '1', 'shlq_r64_imm8')
  {70,0,1926},//('addq_r64_imm8', '0', 'pushq_r64_1')
  {72,1,1131},//('addq_r64_r64', '1', 'leal_r32_m16')
  {2459,0,1134},//('subq_r64_imm8', '0', 'leaq_r64_m16')
  {2508,0,70},//('testq_r64_r64', '0', 'addq_r64_imm8')
  {2508,1,70}//('testq_r64_r64', '1', 'addq_r64_imm8')
};


namespace stoke {

TransformInfo DoubleTransform::operator()(Cfg& cfg) {

  TransformInfo ti;
  ti.success = false;

  // Grab the index of a random instruction
  ti.undo_index[0] = (gen_() % (cfg.get_code().size() - 2)) + 1;
  ti.undo_index[1] = ti.undo_index[0]+1;

  assert(ti.undo_index[1] < cfg.get_code().size());


  ti.undo_instr = cfg.get_code()[ti.undo_index[0]];
  ti.undo_instr2 = cfg.get_code()[ti.undo_index[1]];
  if (is_control_other_than_call(ti.undo_instr.get_opcode()) ||
      is_control_other_than_call(ti.undo_instr2.get_opcode()))
    return ti;

  // Try generating a new instruction
  gadget choice = choices[gen_() % 500]; // note: ignore the last few ones

  auto instr1 = Instruction((Opcode)choice.opcode1);
  const auto& rs = cfg.def_ins(cfg.get_loc(ti.undo_index[0]));
  for (size_t i = 0, ie = instr1.arity(); i < ie; ++i) {
    Operand o = instr1.get_operand<R64>(i);
    if (instr1.maybe_read(i)) {
      if (!pools_.get_read_op(instr1.get_opcode(), i, rs, o)) {
        return ti;
      }
    } else {
      if (!pools_.get_write_op(instr1.get_opcode(), i, rs, o)) {
        return ti;
      }
    }
    instr1.set_operand(i, o);
  }
  if (!instr1.check()) {
    return ti;
  }

  const auto& instr1_written = instr1.maybe_write_set();

  // Here we can optionally re-pick a gadget to see if the gadgets are actually
  // useful.
  // choice = choices[gen_() % 500]; // note: ignore the last few ones

  auto instr2 = Instruction((Opcode)choice.opcode2);

  for (size_t i = 0, ie = instr2.arity(); i < ie; ++i) {
    Operand o = instr2.get_operand<R64>(i);
    if ((int)i == choice.index) {
      if (instr2.maybe_read(i)) {
        if (!pools_.get_read_op(instr2.get_opcode(), i, instr1_written, o)) {
          return ti;
        }
      } else {
        if (!pools_.get_write_op(instr2.get_opcode(), i, instr1_written, o)) {
          return ti;
        }
      }
    } else {
      if (instr2.maybe_read(i)) {
        if (!pools_.get_read_op(instr2.get_opcode(), i, rs, o)) {
          return ti;
        }
      } else {
        if (!pools_.get_write_op(instr2.get_opcode(), i, rs, o)) {
          return ti;
        }
      }
    }
    instr2.set_operand(i, o);
  }

  // Check that the instruction is valid
  if (!instr2.check()) {
    return ti;
  }

  // Success: Any failure beyond here will require undoing the move
  cfg.get_function().replace(ti.undo_index[0], instr1, false, true);
  cfg.get_function().replace(ti.undo_index[1], instr2, false, true);
  cfg.recompute_defs();
  if (!cfg.check_invariants()) {
    undo(cfg, ti);
    return ti;
  }

  assert(cfg.invariant_no_undef_reads());
  assert(cfg.get_function().check_invariants());


  ti.success = true;
  return ti;
}

void DoubleTransform::undo(Cfg& cfg, const TransformInfo& ti) const {
  cfg.get_function().replace(ti.undo_index[0], ti.undo_instr, true);
  cfg.get_function().replace(ti.undo_index[1], ti.undo_instr2, true);
  cfg.recompute_defs();

  assert(cfg.invariant_no_undef_reads());
  assert(cfg.get_function().check_invariants());


}



} // namespace stoke

